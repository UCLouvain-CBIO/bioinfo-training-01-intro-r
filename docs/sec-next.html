<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 8 Next steps | Data manipulation and visualisation with R" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Course material for the Data manipulation and visualisation with R training (SMCS &amp; CBIO, UCLouvain)." />


<meta name="author" content="Laurent Gatto, Manon Martin &amp; Axelle Loriot" />

<meta name="date" content="2021-09-29" />


<meta name="description" content="Course material for the Data manipulation and visualisation with R training (SMCS &amp; CBIO, UCLouvain).">

<title>Chapter 8 Next steps | Data manipulation and visualisation with R</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Data manipulation and visualisation with R<p><p class="author">Laurent Gatto, Manon Martin & Axelle Loriot</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preamble</a>
<a href="sec-dataorg.html"><span class="toc-section-number">1</span> Data organisation with Spreadsheets</a>
<a href="sec-rrstudio.html"><span class="toc-section-number">2</span> R and RStudio</a>
<a href="sec-startr.html"><span class="toc-section-number">3</span> Introduction to R</a>
<a href="sec-startdata.html"><span class="toc-section-number">4</span> Starting with data</a>
<a href="sec-dplyr.html"><span class="toc-section-number">5</span> Manipulating and analyzing data with dplyr</a>
<a href="sec-vis.html"><span class="toc-section-number">6</span> Data visualization</a>
<a href="sec-join.html"><span class="toc-section-number">7</span> Joining tables</a>
<a id="active-page" href="sec-next.html"><span class="toc-section-number">8</span> Next steps</a><ul class="toc-sections">
<li class="toc"><a href="#summarizedexperiment"> SummarizedExperiment</a></li>
</ul>
<a href="session-information.html"><span class="toc-section-number">9</span> Session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="sec-next" class="section level1" number="8">
<h1>
<span class="header-section-number">Chapter 8</span> Next steps</h1>
<p><strong>Objectives</strong></p>
<ul>
<li><p>Introduce the notion of data containers</p></li>
<li><p>Give an overview of the <code>SummarizedExperiment</code>, extensively used in omics analyses</p></li>
</ul>
<p>Data in bioinformatics is often more complex than the basic data types
we have seen so far. To deal with this, developers define specialised
data containers (termed classes) that match the properties of the
data they need to handle.</p>
<p>This aspect is central to the <strong>Bioconductor</strong><label for="tufte-sn-9" class="margin-toggle sidenote-number">9</label><input type="checkbox" id="tufte-sn-9" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">9</span> The <a href="http://www.bioconductor.org">Bioconductor</a> was initiated by
Robert Gentleman, one of the two creators of the R language. Bioconductor provides
tools for the analysis and comprehension of omics data.
Bioconductor uses the R statistical programming language, and is open source and
open development.</span> project which
uses the same <strong>core data infrastructure</strong> across packages. This certainly contributed
to Bioconductor’s success. Bioconductor package developers are advised to make
use of existing infrastructure to provide coherence, interoperability and stability to
the project as a whole.</p>
<p>To illustrate such an omics data container, we’ll present the <code>SummarizedExperiment</code>
class.</p>
<div id="summarizedexperiment" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> SummarizedExperiment<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('summarizedexperiment')" onmouseout="reset_tooltip('summarizedexperiment-tooltip')"><span class="tooltiptext" id="summarizedexperiment-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>The figure below represents the anatomy of SummarizedExperiment.</p>
<p><img src="figs/SE.png" width="80%"></p>
<p>Objects of the class SummarizedExperiment contain :</p>
<ul>
<li><p><strong>One (or more) assay(s)</strong> containing the quantitative omics data
(expression data), stored as a matrix-like object. Features (genes,
transcripts, proteins, …) are defined along the rows and samples
along the columns.</p></li>
<li><p>A <strong>sample metadata</strong> slot containing sample co-variates, stored as a
data frame. Rows from this table represent samples (rows match exactly the
columns of the expression data). Columns from this table represent sample
covariates along the columns.</p></li>
<li><p>A <strong>feature metadata</strong> slot containing feature co-variates, stored as
data frame. The rows of this dataframe’s match exactly the rows of the
expression data.</p></li>
</ul>
<p>The coordinated nature of the high throughput data guarantees that the
dimensions of the different slots will always match (i.e the columns
in the expression data and then rows in the sample metadata, as well
as the rows in the expression data and feature metadata) during data
manipulation.</p>
<p>The metadata slots can grow additional co-variates
(columns) without affecting the other structures.</p>
<div id="creating-a-summarizedexperiment" class="section level3" number="8.1.1">
<h3>
<span class="header-section-number">8.1.1</span> Creating a SummarizedExperiment<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('creating-a-summarizedexperiment')" onmouseout="reset_tooltip('creating-a-summarizedexperiment-tooltip')"><span class="tooltiptext" id="creating-a-summarizedexperiment-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Let’s return to the <code>rna</code> dataset that we have used previously.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="sec-next.html#cb543-1" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rnaseq.csv"</span>)</span>
<span id="cb543-2"><a href="sec-next.html#cb543-2" aria-hidden="true" tabindex="-1"></a>rna</span></code></pre></div>
<pre><code>## # A tibble: 32,428 × 19
##    gene    sample  expression organism   age sex   infection strain  time tissue
##    &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; 
##  1 Asl     GSM254…       1170 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  2 Apod    GSM254…      36194 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  3 Cyp2d22 GSM254…       4060 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  4 Klk6    GSM254…        287 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  5 Fcrls   GSM254…         85 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  6 Slc2a4  GSM254…        782 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  7 Exd2    GSM254…       1619 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  8 Gjc2    GSM254…        288 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
##  9 Plp1    GSM254…      43217 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
## 10 Gnb4    GSM254…       1071 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
## # … with 32,418 more rows, and 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;,
## #   product &lt;chr&gt;, ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;,
## #   chromosome_name &lt;chr&gt;, gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
## #   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="sec-next.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rna)</span></code></pre></div>
<pre><code>##  [1] "gene"                                 
##  [2] "sample"                               
##  [3] "expression"                           
##  [4] "organism"                             
##  [5] "age"                                  
##  [6] "sex"                                  
##  [7] "infection"                            
##  [8] "strain"                               
##  [9] "time"                                 
## [10] "tissue"                               
## [11] "mouse"                                
## [12] "ENTREZID"                             
## [13] "product"                              
## [14] "ensembl_gene_id"                      
## [15] "external_synonym"                     
## [16] "chromosome_name"                      
## [17] "gene_biotype"                         
## [18] "phenotype_description"                
## [19] "hsapiens_homolog_associated_gene_name"</code></pre>
<p>In this table, we can find gene expression per gene and per sample, as well as
columns describing the samples (orgnanism, age, sex…), and columns describing
the genes (ENTREZID, product, chromosome_name, gene_biotype…)</p>
<p>We will convert this table in a <code>SummarizedExperiment</code>.
To do so we will extract from this table:</p>
<ul>
<li><p>A count matrix that will be used as the <strong><code>assay</code></strong></p></li>
<li><p>A table describing the samples that will be used as the <strong>sample metadata</strong> slot</p></li>
<li><p>A table describing the genes that will be used as the <strong>features metadata</strong> slot</p></li>
</ul>
<p><strong>count matrix</strong></p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="sec-next.html#cb547-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> rna <span class="sc">%&gt;%</span></span>
<span id="cb547-2"><a href="sec-next.html#cb547-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene, sample, expression) <span class="sc">%&gt;%</span> </span>
<span id="cb547-3"><a href="sec-next.html#cb547-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sample,</span>
<span id="cb547-4"><a href="sec-next.html#cb547-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> expression) </span>
<span id="cb547-5"><a href="sec-next.html#cb547-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-6"><a href="sec-next.html#cb547-6" aria-hidden="true" tabindex="-1"></a>count_matrix <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>gene) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb547-7"><a href="sec-next.html#cb547-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(count_matrix) <span class="ot">&lt;-</span> counts<span class="sc">$</span>gene</span>
<span id="cb547-8"><a href="sec-next.html#cb547-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-9"><a href="sec-next.html#cb547-9" aria-hidden="true" tabindex="-1"></a>count_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>##         GSM2545336 GSM2545337 GSM2545338 GSM2545339 GSM2545340 GSM2545341
## Asl           1170        361        400        586        626        988
## Apod         36194      10347       9173      10620      13021      29594
## Cyp2d22       4060       1616       1603       1901       2171       3349
## Klk6           287        629        641        578        448        195
##         GSM2545342 GSM2545343 GSM2545344 GSM2545345 GSM2545346 GSM2545347
## Asl            836        535        586        597        938       1035
## Apod         24959      13668      13230      15868      27769      34301
## Cyp2d22       3122       2008       2254       2277       2985       3452
## Klk6           186       1101        537        567        327        233
##         GSM2545348 GSM2545349 GSM2545350 GSM2545351 GSM2545352 GSM2545353
## Asl            494        481        666        937        803        541
## Apod         11258      11812      15816      29242      20415      13682
## Cyp2d22       1883       2014       2417       3678       2920       2216
## Klk6           742        881        828        250        798        710
##         GSM2545354 GSM2545362 GSM2545363 GSM2545380
## Asl            473        748        576       1192
## Apod         11088      15916      11166      38148
## Cyp2d22       1821       2842       2011       4019
## Klk6           894        501        598        259
##  [ reached getOption("max.print") -- omitted 1 row ]</code></pre>
<p><strong>table describing the samples</strong></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="sec-next.html#cb549-1" aria-hidden="true" tabindex="-1"></a>sample_metadata <span class="ot">&lt;-</span> rna <span class="sc">%&gt;%</span></span>
<span id="cb549-2"><a href="sec-next.html#cb549-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample, organism, age, sex, infection, strain, time, tissue, mouse) </span>
<span id="cb549-3"><a href="sec-next.html#cb549-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-4"><a href="sec-next.html#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Many lines are repeated, as in rna, each gene (n = 1474) was analysed in each sample!</span></span>
<span id="cb549-5"><a href="sec-next.html#cb549-5" aria-hidden="true" tabindex="-1"></a>sample_metadata</span></code></pre></div>
<pre><code>## # A tibble: 32,428 × 9
##    sample     organism       age sex    infection  strain   time tissue    mouse
##    &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  2 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  3 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  4 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  5 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  6 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  7 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  8 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
##  9 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
## 10 GSM2545336 Mus musculus     8 Female InfluenzaA C57BL/6     8 Cerebell…    14
## # … with 32,418 more rows</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="sec-next.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove redundancy</span></span>
<span id="cb551-2"><a href="sec-next.html#cb551-2" aria-hidden="true" tabindex="-1"></a>sample_metadata <span class="ot">&lt;-</span> <span class="fu">unique</span>(sample_metadata)</span>
<span id="cb551-3"><a href="sec-next.html#cb551-3" aria-hidden="true" tabindex="-1"></a>sample_metadata</span></code></pre></div>
<pre><code>## # A tibble: 22 × 9
##    sample     organism       age sex    infection   strain   time tissue   mouse
##    &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1 GSM2545336 Mus musculus     8 Female InfluenzaA  C57BL/6     8 Cerebel…    14
##  2 GSM2545337 Mus musculus     8 Female NonInfected C57BL/6     0 Cerebel…     9
##  3 GSM2545338 Mus musculus     8 Female NonInfected C57BL/6     0 Cerebel…    10
##  4 GSM2545339 Mus musculus     8 Female InfluenzaA  C57BL/6     4 Cerebel…    15
##  5 GSM2545340 Mus musculus     8 Male   InfluenzaA  C57BL/6     4 Cerebel…    18
##  6 GSM2545341 Mus musculus     8 Male   InfluenzaA  C57BL/6     8 Cerebel…     6
##  7 GSM2545342 Mus musculus     8 Female InfluenzaA  C57BL/6     8 Cerebel…     5
##  8 GSM2545343 Mus musculus     8 Male   NonInfected C57BL/6     0 Cerebel…    11
##  9 GSM2545344 Mus musculus     8 Female InfluenzaA  C57BL/6     4 Cerebel…    22
## 10 GSM2545345 Mus musculus     8 Male   InfluenzaA  C57BL/6     4 Cerebel…    13
## # … with 12 more rows</code></pre>
<p><strong>table describing the genes</strong></p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="sec-next.html#cb553-1" aria-hidden="true" tabindex="-1"></a>gene_metadata <span class="ot">&lt;-</span> rna <span class="sc">%&gt;%</span></span>
<span id="cb553-2"><a href="sec-next.html#cb553-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene, ENTREZID, product, ensembl_gene_id, external_synonym, chromosome_name, gene_biotype, phenotype_description, hsapiens_homolog_associated_gene_name)      </span>
<span id="cb553-3"><a href="sec-next.html#cb553-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-4"><a href="sec-next.html#cb553-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove redundancy</span></span>
<span id="cb553-5"><a href="sec-next.html#cb553-5" aria-hidden="true" tabindex="-1"></a>gene_metadata <span class="ot">&lt;-</span> <span class="fu">unique</span>(gene_metadata)</span>
<span id="cb553-6"><a href="sec-next.html#cb553-6" aria-hidden="true" tabindex="-1"></a>gene_metadata</span></code></pre></div>
<pre><code>## # A tibble: 1,474 × 9
##    gene    ENTREZID product     ensembl_gene_id external_synonym chromosome_name
##    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;          
##  1 Asl       109900 argininosu… ENSMUSG0000002… 2510006M18Rik    5              
##  2 Apod       11815 apolipopro… ENSMUSG0000002… &lt;NA&gt;             16             
##  3 Cyp2d22    56448 cytochrome… ENSMUSG0000006… 2D22             15             
##  4 Klk6       19144 kallikrein… ENSMUSG0000005… Bssp             7              
##  5 Fcrls      80891 Fc recepto… ENSMUSG0000001… 2810439C17Rik    3              
##  6 Slc2a4     20528 solute car… ENSMUSG0000001… Glut-4           11             
##  7 Exd2       97827 exonucleas… ENSMUSG0000003… 4930539P14Rik    12             
##  8 Gjc2      118454 gap juncti… ENSMUSG0000004… B230382L12Rik    11             
##  9 Plp1       18823 proteolipi… ENSMUSG0000003… DM20             X              
## 10 Gnb4       14696 guanine nu… ENSMUSG0000002… 6720453A21Rik    3              
## # … with 1,464 more rows, and 3 more variables: gene_biotype &lt;chr&gt;,
## #   phenotype_description &lt;chr&gt;, hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
<p>We can now put the different parts together using the
<code>SummarizedExperiment</code> constructor:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="sec-next.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BiocManager::install("SummarizedExperiment")</span></span>
<span id="cb555-2"><a href="sec-next.html#cb555-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"SummarizedExperiment"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="sec-next.html#cb556-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">SummarizedExperiment</span>(<span class="at">assays =</span> count_matrix,</span>
<span id="cb556-2"><a href="sec-next.html#cb556-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">colData =</span> sample_metadata,</span>
<span id="cb556-3"><a href="sec-next.html#cb556-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rowData =</span> gene_metadata)</span>
<span id="cb556-4"><a href="sec-next.html#cb556-4" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 1474 22 
## metadata(0):
## assays(1): ''
## rownames(1474): Asl Apod ... Pbx1 Rgs4
## rowData names(9): gene ENTREZID ... phenotype_description
##   hsapiens_homolog_associated_gene_name
## colnames(22): GSM2545336 GSM2545337 ... GSM2545363 GSM2545380
## colData names(9): sample organism ... tissue mouse</code></pre>
<p>Using this data structure, we can access the expression matrix with
the <code>assay</code> function, the feature metadata with the <code>rowData</code> function,
and the sample metadata with the <code>colData</code> function:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="sec-next.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">assay</span>(se))</span></code></pre></div>
<pre><code>## [1] 1474   22</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="sec-next.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">assay</span>(se))</span></code></pre></div>
<pre><code>##         GSM2545336 GSM2545337 GSM2545338 GSM2545339 GSM2545340 GSM2545341
## Asl           1170        361        400        586        626        988
## Apod         36194      10347       9173      10620      13021      29594
## Cyp2d22       4060       1616       1603       1901       2171       3349
## Klk6           287        629        641        578        448        195
##         GSM2545342 GSM2545343 GSM2545344 GSM2545345 GSM2545346 GSM2545347
## Asl            836        535        586        597        938       1035
## Apod         24959      13668      13230      15868      27769      34301
## Cyp2d22       3122       2008       2254       2277       2985       3452
## Klk6           186       1101        537        567        327        233
##         GSM2545348 GSM2545349 GSM2545350 GSM2545351 GSM2545352 GSM2545353
## Asl            494        481        666        937        803        541
## Apod         11258      11812      15816      29242      20415      13682
## Cyp2d22       1883       2014       2417       3678       2920       2216
## Klk6           742        881        828        250        798        710
##         GSM2545354 GSM2545362 GSM2545363 GSM2545380
## Asl            473        748        576       1192
## Apod         11088      15916      11166      38148
## Cyp2d22       1821       2842       2011       4019
## Klk6           894        501        598        259
##  [ reached getOption("max.print") -- omitted 2 rows ]</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="sec-next.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(se)</span></code></pre></div>
<pre><code>## DataFrame with 22 rows and 9 columns
##                 sample     organism       age         sex   infection
##            &lt;character&gt;  &lt;character&gt; &lt;numeric&gt; &lt;character&gt; &lt;character&gt;
## GSM2545336  GSM2545336 Mus musculus         8      Female  InfluenzaA
## GSM2545337  GSM2545337 Mus musculus         8      Female NonInfected
## GSM2545338  GSM2545338 Mus musculus         8      Female NonInfected
## GSM2545339  GSM2545339 Mus musculus         8      Female  InfluenzaA
## GSM2545340  GSM2545340 Mus musculus         8        Male  InfluenzaA
## ...                ...          ...       ...         ...         ...
## GSM2545353  GSM2545353 Mus musculus         8      Female NonInfected
## GSM2545354  GSM2545354 Mus musculus         8        Male NonInfected
## GSM2545362  GSM2545362 Mus musculus         8      Female  InfluenzaA
## GSM2545363  GSM2545363 Mus musculus         8        Male  InfluenzaA
##                 strain      time      tissue     mouse
##            &lt;character&gt; &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;
## GSM2545336     C57BL/6         8  Cerebellum        14
## GSM2545337     C57BL/6         0  Cerebellum         9
## GSM2545338     C57BL/6         0  Cerebellum        10
## GSM2545339     C57BL/6         4  Cerebellum        15
## GSM2545340     C57BL/6         4  Cerebellum        18
## ...                ...       ...         ...       ...
## GSM2545353     C57BL/6         0  Cerebellum         4
## GSM2545354     C57BL/6         0  Cerebellum         2
## GSM2545362     C57BL/6         4  Cerebellum        20
## GSM2545363     C57BL/6         4  Cerebellum        12
##  [ reached getOption("max.print") -- omitted 1 row ]</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="sec-next.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">rowData</span>(se))</span></code></pre></div>
<pre><code>## [1] 1474    9</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="sec-next.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rowData</span>(se))</span></code></pre></div>
<pre><code>## DataFrame with 6 rows and 9 columns
##                gene  ENTREZID                product    ensembl_gene_id
##         &lt;character&gt; &lt;numeric&gt;            &lt;character&gt;        &lt;character&gt;
## Asl             Asl    109900 argininosuccinate ly.. ENSMUSG00000025533
## Apod           Apod     11815 apolipoprotein D tra.. ENSMUSG00000022548
## Cyp2d22     Cyp2d22     56448 cytochrome P450 fami.. ENSMUSG00000061740
## Klk6           Klk6     19144 kallikrein related-p.. ENSMUSG00000050063
## Fcrls         Fcrls     80891 Fc receptor-like S s.. ENSMUSG00000015852
## Slc2a4       Slc2a4     20528 solute carrier famil.. ENSMUSG00000018566
##         external_synonym chromosome_name   gene_biotype  phenotype_description
##              &lt;character&gt;     &lt;character&gt;    &lt;character&gt;            &lt;character&gt;
## Asl        2510006M18Rik               5 protein_coding abnormal circulating..
## Apod                  NA              16 protein_coding abnormal lipid homeo..
## Cyp2d22             2D22              15 protein_coding abnormal skin morpho..
## Klk6                Bssp               7 protein_coding abnormal cytokine le..
## Fcrls      2810439C17Rik               3 protein_coding decreased CD8-positi..
## Slc2a4            Glut-4              11 protein_coding abnormal circulating..
##         hsapiens_homolog_associated_gene_name
##                                   &lt;character&gt;
## Asl                                       ASL
## Apod                                     APOD
## Cyp2d22                                CYP2D6
## Klk6                                     KLK6
## Fcrls                                   FCRL4
## Slc2a4                                 SLC2A4</code></pre>
<div id="adding-variables-to-metadata" class="section level4" number="8.1.1.1">
<h4>
<span class="header-section-number">8.1.1.1</span> Adding variables to metadata</h4>
<p>We can also add information to the metadata.
Suppose that you want to add the center where the samples were collected…</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="sec-next.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(se)<span class="sc">$</span>center <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"University of Illinois"</span>, <span class="fu">nrow</span>(<span class="fu">colData</span>(se)))</span>
<span id="cb568-2"><a href="sec-next.html#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(se)</span></code></pre></div>
<pre><code>## DataFrame with 22 rows and 10 columns
##                 sample     organism       age         sex   infection
##            &lt;character&gt;  &lt;character&gt; &lt;numeric&gt; &lt;character&gt; &lt;character&gt;
## GSM2545336  GSM2545336 Mus musculus         8      Female  InfluenzaA
## GSM2545337  GSM2545337 Mus musculus         8      Female NonInfected
## GSM2545338  GSM2545338 Mus musculus         8      Female NonInfected
## GSM2545339  GSM2545339 Mus musculus         8      Female  InfluenzaA
## GSM2545340  GSM2545340 Mus musculus         8        Male  InfluenzaA
## ...                ...          ...       ...         ...         ...
## GSM2545353  GSM2545353 Mus musculus         8      Female NonInfected
## GSM2545354  GSM2545354 Mus musculus         8        Male NonInfected
## GSM2545362  GSM2545362 Mus musculus         8      Female  InfluenzaA
##                 strain      time      tissue     mouse                 center
##            &lt;character&gt; &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;            &lt;character&gt;
## GSM2545336     C57BL/6         8  Cerebellum        14 University of Illinois
## GSM2545337     C57BL/6         0  Cerebellum         9 University of Illinois
## GSM2545338     C57BL/6         0  Cerebellum        10 University of Illinois
## GSM2545339     C57BL/6         4  Cerebellum        15 University of Illinois
## GSM2545340     C57BL/6         4  Cerebellum        18 University of Illinois
## ...                ...       ...         ...       ...                    ...
## GSM2545353     C57BL/6         0  Cerebellum         4 University of Illinois
## GSM2545354     C57BL/6         0  Cerebellum         2 University of Illinois
## GSM2545362     C57BL/6         4  Cerebellum        20 University of Illinois
##  [ reached getOption("max.print") -- omitted 2 rows ]</code></pre>
<p>This illustrates that the metadata slots can grow indefinitely without affecting
the other structures!</p>
</div>
</div>
<div id="subsetting-a-summarizedexperiment" class="section level3" number="8.1.2">
<h3>
<span class="header-section-number">8.1.2</span> Subsetting a SummarizedExperiment<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('subsetting-a-summarizedexperiment')" onmouseout="reset_tooltip('subsetting-a-summarizedexperiment-tooltip')"><span class="tooltiptext" id="subsetting-a-summarizedexperiment-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>SummarizedExperiment can be subset just like with data frames,
with numerics or with characters of logicals.</p>
<p>Below, we create a new instance of class SummarizedExperiment that contains only
the 5 first features for the 3 first samples.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="sec-next.html#cb570-1" aria-hidden="true" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> se[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb570-2"><a href="sec-next.html#cb570-2" aria-hidden="true" tabindex="-1"></a>se1</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 5 3 
## metadata(0):
## assays(1): ''
## rownames(5): Asl Apod Cyp2d22 Klk6 Fcrls
## rowData names(9): gene ENTREZID ... phenotype_description
##   hsapiens_homolog_associated_gene_name
## colnames(3): GSM2545336 GSM2545337 GSM2545338
## colData names(10): sample organism ... mouse center</code></pre>
<p>We can also use the colData() function to subset on something from the sample metadata.
For example, here we keep only the non infected samples.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="sec-next.html#cb572-1" aria-hidden="true" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> se[, <span class="fu">colData</span>(se)<span class="sc">$</span>infection <span class="sc">==</span> <span class="st">"NonInfected"</span>]</span>
<span id="cb572-2"><a href="sec-next.html#cb572-2" aria-hidden="true" tabindex="-1"></a>se1</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 1474 7 
## metadata(0):
## assays(1): ''
## rownames(1474): Asl Apod ... Pbx1 Rgs4
## rowData names(9): gene ENTREZID ... phenotype_description
##   hsapiens_homolog_associated_gene_name
## colnames(7): GSM2545337 GSM2545338 ... GSM2545353 GSM2545354
## colData names(10): sample organism ... mouse center</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="sec-next.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(se1)</span></code></pre></div>
<pre><code>## DataFrame with 7 rows and 10 columns
##                 sample     organism       age         sex   infection
##            &lt;character&gt;  &lt;character&gt; &lt;numeric&gt; &lt;character&gt; &lt;character&gt;
## GSM2545337  GSM2545337 Mus musculus         8      Female NonInfected
## GSM2545338  GSM2545338 Mus musculus         8      Female NonInfected
## GSM2545343  GSM2545343 Mus musculus         8        Male NonInfected
## GSM2545348  GSM2545348 Mus musculus         8      Female NonInfected
## GSM2545349  GSM2545349 Mus musculus         8        Male NonInfected
## GSM2545353  GSM2545353 Mus musculus         8      Female NonInfected
## GSM2545354  GSM2545354 Mus musculus         8        Male NonInfected
##                 strain      time      tissue     mouse                 center
##            &lt;character&gt; &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;            &lt;character&gt;
## GSM2545337     C57BL/6         0  Cerebellum         9 University of Illinois
## GSM2545338     C57BL/6         0  Cerebellum        10 University of Illinois
## GSM2545343     C57BL/6         0  Cerebellum        11 University of Illinois
## GSM2545348     C57BL/6         0  Cerebellum         8 University of Illinois
## GSM2545349     C57BL/6         0  Cerebellum         7 University of Illinois
## GSM2545353     C57BL/6         0  Cerebellum         4 University of Illinois
## GSM2545354     C57BL/6         0  Cerebellum         2 University of Illinois</code></pre>
<p>Of course the rowData() function can similarly be used to keep only certain
features of interest. We could for example focus on miRNAs…</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="sec-next.html#cb576-1" aria-hidden="true" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> se[<span class="fu">rowData</span>(se)<span class="sc">$</span>gene_biotype <span class="sc">==</span> <span class="st">"miRNA"</span>,]</span>
<span id="cb576-2"><a href="sec-next.html#cb576-2" aria-hidden="true" tabindex="-1"></a>se1</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 7 22 
## metadata(0):
## assays(1): ''
## rownames(7): Mir1901 Mir378a ... Mir128-1 Mir7682
## rowData names(9): gene ENTREZID ... phenotype_description
##   hsapiens_homolog_associated_gene_name
## colnames(22): GSM2545336 GSM2545337 ... GSM2545363 GSM2545380
## colData names(10): sample organism ... mouse center</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="sec-next.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assay</span>(se1)</span></code></pre></div>
<pre><code>##          GSM2545336 GSM2545337 GSM2545338 GSM2545339 GSM2545340 GSM2545341
## Mir1901          24         45         44         32         34         26
## Mir378a          12         11          7          6          5         13
## Mir133b           4          4          6          3          8          5
## Mir30c-2          9         10          6         11          6          7
##          GSM2545342 GSM2545343 GSM2545344 GSM2545345 GSM2545346 GSM2545347
## Mir1901          13         74         26         45         19         31
## Mir378a           8          9          5         10         13         14
## Mir133b           3          5          8          2          4          6
## Mir30c-2          7         16          9          7         14         10
##          GSM2545348 GSM2545349 GSM2545350 GSM2545351 GSM2545352 GSM2545353
## Mir1901          55         68         62         37         40         33
## Mir378a           4         12         17          6          5          4
## Mir133b           4          6          4          3          7          7
## Mir30c-2         12          8         11         12         13         17
##          GSM2545354 GSM2545362 GSM2545363 GSM2545380
## Mir1901          60         26         45         35
## Mir378a           8          6         10          5
## Mir133b           3          6          8          6
## Mir30c-2         15          8          8         13
##  [ reached getOption("max.print") -- omitted 3 rows ]</code></pre>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Extract the gene expression levels of the 3 first genes in sample at time 0 and at time 8.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-48" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-48', 'sol-start-48')"></span>
</p>
<div id="sol-body-48" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="sec-next.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assay</span>(se)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">colData</span>(se)<span class="sc">$</span>time <span class="sc">!=</span> <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##         GSM2545336 GSM2545337 GSM2545338 GSM2545341 GSM2545342 GSM2545343
## Asl           1170        361        400        988        836        535
## Apod         36194      10347       9173      29594      24959      13668
## Cyp2d22       4060       1616       1603       3349       3122       2008
##         GSM2545346 GSM2545347 GSM2545348 GSM2545349 GSM2545351 GSM2545353
## Asl            938       1035        494        481        937        541
## Apod         27769      34301      11258      11812      29242      13682
## Cyp2d22       2985       3452       1883       2014       3678       2216
##         GSM2545354 GSM2545380
## Asl            473       1192
## Apod         11088      38148
## Cyp2d22       1821       4019</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="sec-next.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent to</span></span>
<span id="cb582-2"><a href="sec-next.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="fu">assay</span>(se)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">colData</span>(se)<span class="sc">$</span>time <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">colData</span>(se)<span class="sc">$</span>time <span class="sc">==</span> <span class="dv">8</span>]</span></code></pre></div>
<pre><code>##         GSM2545336 GSM2545337 GSM2545338 GSM2545341 GSM2545342 GSM2545343
## Asl           1170        361        400        988        836        535
## Apod         36194      10347       9173      29594      24959      13668
## Cyp2d22       4060       1616       1603       3349       3122       2008
##         GSM2545346 GSM2545347 GSM2545348 GSM2545349 GSM2545351 GSM2545353
## Asl            938       1035        494        481        937        541
## Apod         27769      34301      11258      11812      29242      13682
## Cyp2d22       2985       3452       1883       2014       3678       2216
##         GSM2545354 GSM2545380
## Asl            473       1192
## Apod         11088      38148
## Cyp2d22       1821       4019</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><strong>Take-home message</strong></p>
<ul>
<li><p><code>SummarizedExperiment</code> represent an efficient way to store and to handle omics
data.</p></li>
<li><p>They are used in many Bioconductor packages.</p></li>
</ul>
<p>If you follow next training focused on RNA sequencing analysis, you will learn to
use the Bioconductor <code>DESeq2</code> package to do some differential expression analyses.
<code>DESeq2</code>’s whole analysis is handled in a <code>SummarizedExperiment</code>.</p>

</div>
</div>
</div></body></html>

<p style="text-align: center;">
<a href="sec-join.html"><button class="btn btn-default">Previous</button></a>
<a href="session-information.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-09-29
 using 
R version 4.1.0 (2021-05-18)
</p>
</div>
</div>



</body>
</html>
